<mat-card class="form-card">
  <mat-card-header>
    <mat-card-title>Patient Data Form</mat-card-title>
  </mat-card-header>

  <mat-card-content>
    <form [formGroup]="patientForm" (ngSubmit)="onSubmit()">
      <!-- Notes (required) -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Patient Notes</mat-label>
        <textarea matInput formControlName="notes" rows="4" placeholder="Enter unstructured patient notes or diagnosis..."></textarea>
        <mat-error *ngIf="patientForm.get('notes')?.touched && patientForm.get('notes')?.invalid">
          <small *ngIf="patientForm.get('notes')?.errors?.['required']">Notes are required</small>
        </mat-error>
      </mat-form-field>

      <!-- Age -->
      <mat-form-field appearance="outline">
        <mat-label>Age</mat-label>
        <input matInput type="number" formControlName="age" placeholder="Enter patient age">
        <mat-error *ngIf="patientForm.get('age')?.touched && patientForm.get('age')?.invalid">
          <small *ngIf="patientForm.get('age')?.errors?.['min']">Age cannot be negative</small>
          <small *ngIf="patientForm.get('age')?.errors?.['max']">Age cannot exceed 120</small>
        </mat-error>
      </mat-form-field>

      <!-- Sex -->
      <mat-form-field appearance="outline">
        <mat-label>Sex</mat-label>
        <mat-select formControlName="sex">
          <mat-option value="">-- Select --</mat-option>
          <mat-option value="Male">Male</mat-option>
          <mat-option value="Female">Female</mat-option>
        </mat-select>
      </mat-form-field>

      <!-- Condition -->
      <mat-form-field appearance="outline">
        <mat-label>Condition</mat-label>
        <input matInput formControlName="condition" placeholder="e.g. Diabetes, Cancer, etc.">
      </mat-form-field>

      <!-- Location -->
      <div class="location-fields">
        <mat-form-field appearance="outline">
          <mat-label>City</mat-label>
          <input matInput formControlName="city" placeholder="Enter city">
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>State</mat-label>
          <input matInput formControlName="state" placeholder="Enter state">
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Country</mat-label>
          <input matInput formControlName="country" placeholder="Enter country">
        </mat-form-field>
      </div>

      <div class="form-actions">
        <button mat-raised-button color="primary" type="submit" [disabled]="patientForm.invalid">
          Submit
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>

<!-- Preview Section -->
<div class="preview" *ngIf="submittedData">
  <h3>Preview of Submitted Data:</h3>
  <p><strong>Age:</strong> {{ submittedData.age }}</p>
  <p><strong>Sex:</strong> {{ submittedData.sex }}</p>
  <p><strong>Condition:</strong> {{ submittedData.condition }}</p>
  <p><strong>City:</strong> {{ submittedData.city }}</p>
  <p><strong>State:</strong> {{ submittedData.state }}</p>
  <p><strong>Country:</strong> {{ submittedData.country }}</p>
  <p><strong>Notes:</strong> {{ submittedData.notes }}</p>
</div>